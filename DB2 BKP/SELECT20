SELECT C.NOMECLI, SUM(V.QTDEVENDA * P.PRECOPROD)
FROM TBCLI C, TBVENDA V, TBPROD P
WHERE C.CODCLI = V.CODCLI
  AND V.CODPROD = P.CODPROD
  AND P.CODTIPOPROD IN ('01', '02', '03')
GROUP BY C.NOMECLI
HAVING SUM(V.QTDEVENDA * P.PRECOPROD) > 1000
